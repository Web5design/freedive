<!DOCTYPE html ><html><head><style type='text/css'>div.control1{width:620px; padding: 0 0 20px 0; font-size:0.8em; color:black;}div.control2{height:30px; width:400px;font-size:0.8em; padding: 0 20px 20px 0;}div.control3{float:right; height:30px; font-size:0.8em;vertical-align:inherit;}div.chart1{float: left;}.globalDiv{font-family:Arial, sans-serif; text-align:left; font-size:0.8em;}.header {background-color: #3F3F3F; color: #FFFFFF; font-family:Arial, sans-serif; text-align:left; font-size:0.8em; text-transform:uppercase; font-weight:600;letter-spacing:1px;line-height:1.4em;}.row { background-color: #FFFFFF; color: #3F3F3F;font-family:inherit; font-size:0.9em;}.oddRow { background-color: #F5F5F5; color: #3F3F3F;text-align: center; font-family:inherit; text-align:left; font-size:0.9em;}.hoverRow { background-color: #616161; color: #FFFFFF;text-align: center; font-family:inherit; text-align:left; font-size:0.9em; }.selectedRow { background-color: #DCDCDC; color: #3F3F3F;text-align: center; font-family:inherit; text-align:left; font-size:0.9em; }.cell{padding:2px;}.headCell{padding:0px; }.goog-menu {padding: 8px 0;}.goog-menuitem-content {color: #3F3F3F;}.goog-menuitem-highlight,.goog-menuitem-hover {background-color: #F0F0F0;border-color: #F0F0F0;}.goog-menu-button-focused .goog-menu-button-outer-box,.goog-menu-button-focused .goog-menu-button-inner-box {border-color: #B1B1B1; margin}.goog-menu-button-inner-box {margin:2px 0;}.goog-menu-button-hover .goog-menu-button-outer-box,.goog-menu-button-hover .goog-menu-button-inner-box {border-color: #B1B1B1!important;}.goog-menu-button-active,.goog-menu-button-open {background-color: #F0F0F0;border-color: #B1B1B1;background-position: bottom left}.goog-menu-button-focused .goog-menu-button-outer-box,.goog-menu-button-focused .goog-menu-button-inner-box {border-color: #B1B1B1}.custom-stringfilter input { border: 1px solid #B1B1B1; background-color:#F0F0F0 ; outline:none;height:18px;}.custom-stringfilter input:focus {border-color: #B1B1B1; background-color:#FFF;}.google-visualization-controls-slider-horizontal {border: 0px; background-color: #DBDBDB;  border-radius: 5px; -moz-border-radius: 5px; outline:none; height:8px;}.google-visualization-controls-slider-thumb {background-color: #616161;  border: none;width: 12px; height: 12px; }.google-visualization-controls-slider-horizontal .google-visualization-controls-slider-handle {height: 8px;}.google-visualization-controls-slider-horizontal.google-visualization-controls-slider-thumb {top: -2px; left-margin: 8px; border-radius: 2px;	-moz-border-radius: 2px;}.google-visualization-controls-slider-handle {background-color: #616161; opacity: .6; height:4px}.google-visualization-controls-rangefilter-thumblabel {color: #3F3F3F;padding: 0 0.5em}</style><script type='text/javascript'>var theme_classes = {headerRow: 'header', tableRow: 'row', hoverTableRow: 'hoverRow', oddTableRow: 'oddRow', selectedTableRow:'selectedRow', tableCell:'cell', headderCell:'headCell' };</script></head><body><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script> <script type="text/javascript" src="https://www.google.com/jsapi"></script> <script type="text/javascript"> google.load('visualization', '1.1', {packages:['controls']}); </script> <style type="text/css"> div.control1{width:620px; padding: 0 0 20px 0; font-size:0.9em; color:black; vertical-align: middle;margin:0;} div.control2{height:30px; width:300px;font-size:0.9em; padding: 0 20px 20px 0; vertical-align: middle;margin:0;} div.control3{float:right; height:30px; font-size:0.9em;vertical-align:inherit; vertical-align: middle;margin:0;} div.chart1{float: left;} </style> <script type="text/javascript" charset="utf-8"> $.extend({ getUrlVars: function(){ var vars = [], hash; var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&'); for(var i = 0; i < hashes.length; i++) { hash = hashes[i].split('='); vars.push(hash[0]); vars[hash[0]] = hash[1]; } return vars; }, getUrlVar: function(name){ return $.getUrlVars()[name]; } }); </script> <script type="text/javascript"> anyquery = false; fdnq = decodeURIComponent($.getUrlVar('fdnq')); fdop = decodeURIComponent($.getUrlVar('fdop')); fdtq = decodeURIComponent($.getUrlVar('fdtq')); fdall = decodeURIComponent($.getUrlVar('fdall')); if (fdall != 'undefined') { fdall = true; } else { fdall = false; }; if (fdtq != 'undefined' || fdnq != 'undefined' || fdall == true) { anyquery = true; google.setOnLoadCallback(drawVisualization()); } else { fdtq = 'Enter text'; fdnq = 'Enter a number'; }; function drawVisualization() { var search_url = 'https://spreadsheets.google.com/a/google.com/tq?key=0AtP_YtDJ532RdDcxZUl6Zkl4YkxKcEYzbld4ZDA4SlE'; if (fdtq == 'undefined') { fdtq = ''; }; if (fdnq == 'undefined') { fdnq = ''; }; if (fdall) { var querystring = "select *"; } else { var querystring = "select A,B,F where "; if (fdtq != '' && fdnq == '' ) { querystring = querystring + "A like '%" + fdtq + "%'"; } else if (fdtq == '' && fdnq != '' ) { querystring = querystring + "F" + fdop + fdnq; } else { querystring = querystring + "A like '%" + fdtq + "%'" + " and " + "F" + fdop + fdnq; }; }; querystring = encodeURIComponent(querystring); search_url = search_url + "&tq=" + querystring; search_url = search_url.replace(/#&tq/,'&tq'); var query = new google.visualization.Query(search_url); query.send(handleQueryResponse); } function handleQueryResponse(response) { if (response.isError()) { console.log('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage()); return; } var data = response.getDataTable(); var slider = new google.visualization.ControlWrapper({ 'controlType': 'NumberRangeFilter', 'containerId': 'control1', 'options': { 'filterColumnLabel': 'Contribution', 'minValue': 0, 'ui': { 'label':'cv', }} }); var stringFilter = new google.visualization.ControlWrapper({ 'controlType': 'StringFilter', 'containerId': 'control2', 'options': { 'filterColumnLabel': 'Name', 'matchType':'any', 'ui': { 'label':'zcvb', 'cssClass' : 'custom-stringfilter' }} }); var categoryPicker = new google.visualization.ControlWrapper({ 'controlType': 'CategoryFilter', 'containerId': 'control3', 'options': { 'filterColumnLabel': 'City', 'ui': { 'label':'zcv', 'allowTyping': false, 'allowMultiple': false, }} }); var table = new google.visualization.ChartWrapper({ 'chartType': 'Table', 'containerId': 'chart1', 'options': {'height': '400px', 'width': '800px','allowHtml':'true', 'cssClassNames': theme_classes } }); var dashboard = new google.visualization.Dashboard(document.getElementById('dashboard')). bind([stringFilter,categoryPicker, slider], table). draw(data); $('div#dashboard').show(); }; </script> <div id="full_search" style=" width:800px; background-color:#DADADA; padding:10px 0 10px 20px;"> <h2> cxvb </h2> <p> zcbv </p> <p style="font-size:12px; line-height:30px"> <label for="search_text">Name includes:</label> <input id="search_text" value="Enter text" style="color:#656565"> <span style="color:#3F3F3F; font-size:10px">Note: Search is case-sensitive!</span><br /> <label for="range_num">Contribution</label> <select name="sheet_op" id="sheet_op"> <option value=">=">Greater than or equal to</option> <option value="<=">Less than or equal to</option> <option value=">">Greater than</option> <option value="<">Less than</option> <option value="=">Equals</option> </select> <input id="range_num" value="Enter a number" style="color:#656565"><br /> <input type="submit" value="Search" onclick="refresh()"> <br /> <span style="color:#3F3F3F; font-size:12px">Improve performance by limiting your search terms. "Open" search terms may cause long load times on large databases.</span> </p> </div> <div id="dashboard" style='width: 800px;font-family:Arial, sans-serif;'> <h3>Explore your results</h3> <p>You can use the slider, text filter and picker to investigate your search results or click on a column label to resort the table. To perform a new search, use the tool above. <div id="control1" class="control1"></div> <div id="control3" class="control3"></div> <div id="control2" class="control2"></div> <div style="width:100%; margin-bottom:10px">Click on a column label to sort the table.</div> <div id="chart1" class="chart1"></div> <div style="font-size:.8em; color:gray; line-height:40px;"> Powered by <a href="">freeDive</a> </div> </div> <script type="text/javascript" charset="utf-8" > if (anyquery == false) { $('div#dashboard').hide(); }; $('input#search_text').val(fdtq); $('input#range_num').val(fdnq); function refresh() { var fdop = $('#sheet_op').val(); var fdnq = $('#range_num').val(); var fdtq = $('#search_text').val(); var sURL = window.location.href; sURL = sURL.replace(/(fdtq=.*&|fdtq=.*$)/gi,''); sURL = sURL.replace(/(fdnq=.*&|fdnq=.*$)/gi,''); sURL = sURL.replace(/(fdop=.*&|fdop=.*$)/gi,''); sURL = sURL.replace(/(fdall=.*&|fdall=.*$)/gi,''); sURL = sURL.replace(/&$/,''); var qs = ''; var found = sURL.search('\\?'); if (found == -1) { qs = "?"; }; if (fdnq == "Enter a number") {fdnq = ''}; if (fdtq == "Enter text") {fdtq = ''}; if (fdnq == '' && fdtq == '') { var allrecs = true; }; if (allrecs) { qs = qs + "fdall=true" ; } else { qs = qs + "&fdop=" + encodeURIComponent(fdop) + "&fdnq=" + encodeURIComponent(fdnq) + "&fdtq=" + encodeURIComponent(fdtq); }; sURL = sURL + qs; window.location.replace(sURL); } </script> <script type="text/javascript" charset="utf-8"> $(document).ready(function(){ $('input#range_num').focus(function() { if($(this).val() == 'Enter a number') $(this).val(''); }).blur(function() { if( $(this).val() == '') $(this).val('Enter a number'); }); $('input#search_text').focus(function() { if($(this).val() == 'Enter text') $(this).val(''); }).blur(function() { if( $(this).val() == '') $(this).val('Enter text'); }); }); </script> </body></html>